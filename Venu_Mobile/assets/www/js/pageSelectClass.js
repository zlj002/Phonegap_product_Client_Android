var classListPageIndex=1;var pSelectClass={initialize:function(){this.bindEvents()},bindData:function(a,s){var e=serverHost+"/MobileService/SchoolService/SchoolWebService.asmx/GetClassByName";$.ui.showMask("请稍等……");var l={schoolID:pmain.getSchoolInfo().ID,className:a,pageIndex:s};$.ajax({type:"Post",contentType:"application/json; charset=utf-8",url:e,data:MY_JSON.stringify(l),dataType:"json",success:function(e){var l=MY_JSON.parse(e.d);if($("#ulClassList .liSelectHeader").length==0){var t=$("<li  class='liSelectHeader'>班级列表</li>");$("#ulClassList").append(t)}if(l.ReturnFlag==1&&l.List.length>0){$.each(l.List,function(a,s){var e=$("<li  class='liSelect'>"+s.Name+"</li>");e.unbind().on("tap",function(){$("#txtClassID_MyInfo_Edit").val(s.ID);$("#divClassName_MyInfo_Edit").html(s.Name);$.ui.goBack()});$("#ulClassList").append(e)});if(s<l.PageCount){var i=$("<li  class='liMore'>加载更多</li>");i.unbind().on("tap",function(){$("#ulClassList li:last ").remove();classListPageIndex++;pSelectClass.bindData(a,classListPageIndex)});$("#ulClassList").append(i)}}else{if($("#ulClassList[nodata=1]").length==0){var t=$("<li  class='liSelect' nodata='1'>暂无结果</li>");$("#ulClassList").append(t)}}$.ui.hideMask()},error:function(a,s,e){$.ui.hideMask();$.ui.popup({title:"提示",message:"获取数据出错",cancelText:"确定",cancelCallback:function(){},cancelOnly:true})}})},bindEvents:function(){$("#btnSearchClass").unbind().on("tap",function(){$("#ulClassList li").not(":first").remove();classListPageIndex=1;pSelectClass.bindData($("#textClassSearch").val(),classListPageIndex)});$("#ulClassList li").remove();pSelectClass.bindData($("#textClassSearch").val(),classListPageIndex)}};