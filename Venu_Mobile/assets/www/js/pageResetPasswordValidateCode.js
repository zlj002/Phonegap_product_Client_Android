var timerResetPwd=60;var pResetPasswordValidateCode={initialize:function(){this.bindEvents();this.bindResendMessage_ResetPwd()},bindData:function(){},bindResendMessage_ResetPwd:function(){window.setTimeout(function(){timerResetPwd--;if(timerResetPwd>0){$("#btnResendMessage_ResetPWD").text("重发("+timerResetPwd+"S)");pResetPasswordValidateCode.bindResendMessage_ResetPwd()}else{$("#btnResendMessage_ResetPWD").text("重发");$("#btnResendMessage_ResetPWD").unbind().on("tap",function(){var e=pmain.getUserInfo().MobileNumber;var s=serverHost+"/MobileService/UserService/UserService.asmx/GenResetPasswordMobileCode";$.ui.showMask("请稍等……");var t={schoolID:pmain.getSchoolInfo().ID,mobileNumber:e};$.ajax({type:"Post",contentType:"application/json; charset=utf-8",url:s,data:MY_JSON.stringify(t),dataType:"json",success:function(e){var s=MY_JSON.parse(e.d);if(s.ReturnFlag==1){$("#btnResendMessage_ResetPWD").unbind();btnResendMessage_ResetPWD=60;pResetPasswordValidateCode.bindResendMessage_ResetPwd()}else{$.ui.popup({title:"提示",message:s.ReturnMessage,cancelText:"确定",cancelCallback:function(){},cancelOnly:true})}$.ui.hideMask()},error:function(e,s,t){$.ui.hideMask();$.ui.popup({title:"提示",message:"短验证码发送失败，请稍后再试",cancelText:"确定",cancelCallback:function(){},cancelOnly:true})}})})}},1e3)},bindEvents:function(){$("#btnResetPasswordValidateCode").unbind().on("tap",function(){var e=$("#txtResetPasswordValidateCode").val();var s=serverHost+"/MobileService/UserService/UserService.asmx/VerifyMobileCode";$.ui.showMask("请稍等……");var t={schoolID:pmain.getSchoolInfo().ID,mobileNumber:pmain.getUserInfo().MobileNumber,messageCode:e};$.ajax({type:"Post",contentType:"application/json; charset=utf-8",url:s,data:MY_JSON.stringify(t),dataType:"json",success:function(e){var s=MY_JSON.parse(e.d);if(s.ReturnFlag==1){$.ui.loadContent("#pageResetPassword",false,false,"left")}else{$.ui.popup({title:"提示",message:s.ReturnMessage,cancelText:"确定",cancelCallback:function(){},cancelOnly:true})}$.ui.hideMask()},error:function(e,s,t){$.ui.hideMask();$.ui.popup({title:"提示",message:"服务器异常请稍后再试",cancelText:"确定",cancelCallback:function(){},cancelOnly:true})}})})}};