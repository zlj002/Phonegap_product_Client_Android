var installListFromServer;var pageNotLogin={initialize:function(){var e=localMobelInfo.getSchoolServerHost();if(e==null||e==""){$.ui.loadContent("#pageSelectSchool",false,false,"left");return}else{$.ui.showMask("正在加载……");var t={schoolID:pmain.getSchoolInfo().ID,panelID:"notLogin"};var i=serverHost+"/MobileService/SchoolService/SchoolWebService.asmx/GetHtmlContentBySchoolIDAndPanelID";$.ajax({type:"Post",contentType:"application/json; charset=utf-8",url:i,data:MY_JSON.stringify(t),dataType:"json",success:function(t){var i=MY_JSON.parse(t.d);$.ui.hideMask();var o='<div class="panelAll"><div class="bgImageBottom"><div class="header87" style="padding-left: 20px;padding-top: 7px;"><div style="float:left;"><img src="img/noLogo.png" style="width:70px;height:70px;" id="imgSchoolLogo" /></div><div class="schoolName"><div id="divSchoolName"></div><div class="englishSchoolName" id="divSchoolEnglishName"></div></div></div><div class="panelContent"><div id="mySwipe" class="swipe"><div class="swipe-wrap"></div></div><div class="panelBottom"><div style="width:100%;text-align:center;"><span id="notLoginPosition" style="font-size: 14px"><em class="on">&bull;</em><em>&bull;</em></span></div><div style="width:100%;height:70px;"><a class="button btnLogin" id="btnToLogin">帐号登录</a></div><div style="float: left; text-align:center; padding-top: 15px;width:50% "><a class="button panelBottomBtn" href="#RegisterUser" style=" width: 100px; ">新用户注册</a></div><div style="float: left; text-align: center; padding-top: 15px; width: 50%;"><a class="button panelBottomBtn" href="#pageSelectSchool" style=" width: 100px; ">切换学校</a></div></div></div></div></div>';if(i.HTMLContent!=null&&i.HTMLContent!=""){o=i.HTMLContent}$("#notLogin").html(o);if(MY_JSON.parse(e).LogoUrl){$("#imgSchoolLogo").attr("src",MY_JSON.parse(e).LogoUrl)}$("#divSchoolName").html(MY_JSON.parse(e).Name);$("#divSchoolEnglishName").html(MY_JSON.parse(e).EnglishName);pageNotLogin.bindData()},error:function(e){$.ui.hideMask();$.ui.popup({title:"提示",message:"自定义页面服务出错",cancelText:"确定",cancelCallback:function(){},cancelOnly:true})}})}},bindData:function(){if(serverHost!=""){$.ui.showMask("正在加载……");var e={schoolID:pmain.getSchoolInfo().ID,userID:localMobelInfo.getUserName()};var t=serverHost+"/MobileService/UserService/UserService.asmx/GetSys_FeatureByCurrentUser";$.ajax({type:"Post",contentType:"application/json; charset=utf-8",url:t,data:MY_JSON.stringify(e),dataType:"json",success:function(e){var t=MY_JSON.parse(e.d);installListFromServer=t.List;pageNotLogin.initApps();$.ui.hideMask()},error:function(e){$.ui.hideMask();$.ui.popup({title:"提示",message:"服务器地址"+serverHost+"异常，请检查配置",cancelText:"确定",cancelCallback:function(){},cancelOnly:true})}})}else{installListFromServer=installAppList;pageNotLogin.initApps()}},initApps:function(){$("#mySwipe .swipe-wrap").html("");$("#notLoginPosition").html("");var e="myNewMessageRed46";$.each(installListFromServer,function(e,t){if($(".swipe-wrap .col3").length%9==0){var i=$('<div><div class="grid"></div></div>');$("#mySwipe .swipe-wrap").append(i);var o=$("<em >&bull;</em>");$("#notLoginPosition").append(o)}var n=$('<div class="col3" style="padding-left:0px;"><a  thirdpartyurl="'+t.FeatureUrl+'" topanelid="#'+t.FeatureID+'" ><img src="'+t.FeatureIcon+'"  /><br /><font class="featureFont">'+t.FeatureName+"</font></a></div>");$("#mySwipe .swipe-wrap .grid:last").append(n)});$("#notLoginPosition em:first").addClass("on");pageNotLogin.initLeftRightTab();pageNotLogin.bindEvents()},bindEvents:function(){$("#btnToLogin").unbind().on("click",function(){$.ui.loadContent("#login",false,false,"left")});$.each($(".swipe-wrap .col3"),function(e,t){var i=$(t).find("a").attr("topanelid");var o=$(t).find("a").attr("thirdpartyurl");var n=encodeURIComponent($(t).find("[class=featureFont]").html());$(t).unbind().on("click",function(){if(o==null||typeof o=="undefined"||o=="null"||o==""){$.ui.loadContent(i,false,false,"left")}else{if(o.indexOf("?")>-1){o=o+"&vUserNO="+localMobelInfo.getUserName()+"&vUserType="+localMobelInfo.getUserType()+"&vSchoolID="+pmain.getSchoolInfo().ID+"&vTitle="+n}else{o=o+"?vUserNO="+localMobelInfo.getUserName()+"&vUserType="+localMobelInfo.getUserType()+"&vSchoolID="+pmain.getSchoolInfo().ID+"&vTitle="+n}var e=window.open(o,"_blank","clearcache=yes")}})})},initLeftRightTab:function(){var e=document.getElementById("notLoginPosition").getElementsByTagName("em");var t=document.getElementById("mySwipe");window.sw=new Swipe(t,{startSlide:0,speed:400,continuous:false,disableScroll:false,stopPropagation:false,callback:function(e,t){$.each($("#notLoginPosition em"),function(t,i){if(e==t){$(i).addClass("on")}else{$(i).removeClass("on")}})},transitionEnd:function(e,t){}})}};